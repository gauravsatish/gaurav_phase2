# 1. Buffer Overflow 0

> Let's start off simple, can you overflow the correct buffer? The program is available here. You can view source here. Connect using: nc saturn.picoctf.net 56890

## Solution:

Looking at vuln.c:
```c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>

#define FLAGSIZE_MAX 64

char flag[FLAGSIZE_MAX];

void sigsegv_handler(int sig) {
  printf("%s\n", flag);
  fflush(stdout);
  exit(1);
}

void vuln(char *input){
  char buf2[16];
  strcpy(buf2, input);
}

int main(int argc, char **argv){
  
  FILE *f = fopen("flag.txt","r");
  if (f == NULL) {
    printf("%s %s", "Please create 'flag.txt' in this directory with your",
                    "own debugging flag.\n");
    exit(0);
  }
  
  fgets(flag,FLAGSIZE_MAX,f);
  signal(SIGSEGV, sigsegv_handler); // Set up signal handler
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);


  printf("Input: ");
  fflush(stdout);
  char buf1[100];
  gets(buf1); 
  vuln(buf1);
  printf("The program will exit now\n");
  return 0;
}

```

We can see the program takes in an input, and calls the `vuln` function. It also sets up a signal handler, so that in the case of a crash, the program can exit gracefully. Here, it handles SIGSEGV, which happens in the case of a segmentation fault. As I quite painfully learnt from PPS Lab, seg faults can most easily be created by going out of bounds in an array. This happens because the program tries to access memory that it is not allowed to. The kernel of your OS keeps track of all memory allocated to each program. In the vuln function, the input string is being copied into a buffer of 16 bytes, and by giving a string thats more than 16 characters in length, we can create a buffer overflow. The reason that this is even happening is because the string is being inputted with gets(), which does not perform out of bounds checking. Contrary to what we learn in PPS, the ideal way to input strings is using the fgets() function.

```
nc saturn.picoctf.net 56890
Input: ueh08gfy 0817398598y8y98y19835
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
```

## Flag:

```
picoCTF{ov3rfl0ws_ar3nt_that_bad_9f2364bc}
```

## Concepts learnt:

- Already knew about buffer overflows, so this was a helpful revision :)

## Notes:

- None

## Resources:

- None


***
